<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Survey System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root {
            --primary-color: #9C27B0;
            --secondary-color: #b084ff;
            --text-color: #E6E6FA;
            --dark-bg: #1a1a1a;
            --darker-bg: #121212;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: Arial, sans-serif;
            background-color: black;
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        /* Modal Container */
        .modal-container {
            width: 100%;
            max-width: 600px;
            background: linear-gradient(145deg, #1a1a1a, #2a2a2a);
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            padding: 30px;
            position: relative;
            margin: 20px 0;
        }

        /* Modal Header */
        .modal-header {
            font-size: clamp(1.5rem, 5vw, 2rem);
            font-weight: bold;
            margin-bottom: 20px;
            color: var(--secondary-color);
            text-align: center;
        }

        /* Modal Content */
        .modal-content {
            display: none;
            flex: 1;
            padding: 10px 0;
        }

        .modal-content.active {
            display: block;
        }

        .modal-content p {
            margin-bottom: 15px;
            font-size: clamp(1rem, 3vw, 1.1rem);
            line-height: 1.5;
        }

        /* Modal Buttons */
        .modal-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            gap: 15px;
        }

        .modal-buttons button {
            flex: 1;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px;
            cursor: pointer;
            font-size: clamp(0.9rem, 3vw, 1rem);
            transition: all 0.3s ease;
        }

        .modal-buttons button:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        .modal-buttons button:disabled {
            background-color: #555;
            cursor: not-allowed;
            transform: none;
        }

        /* Dropdown Styling */
        select {
            background: linear-gradient(145deg, #1a1a1a, #2a2a2a);
            color: white;
            border: 2px solid var(--primary-color);
            border-radius: 8px;
            padding: 12px;
            font-size: clamp(0.9rem, 3vw, 1rem);
            width: 100%;
            margin-bottom: 20px;
            box-shadow: 4px 4px 8px #0c0c0c, -4px -4px 8px #262626;
            transition: all 0.3s ease;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 20px;
        }

        select:hover, select:focus {
            outline: none;
            box-shadow: 0 0 10px var(--primary-color);
        }

        /* Checkbox Styling */
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        input[type="checkbox"] {
            display: none;
        }

        input[type="checkbox"] + label {
            position: relative;
            padding-left: 35px;
            cursor: pointer;
            color: white;
            font-size: clamp(0.9rem, 3vw, 1rem);
            display: block;
            line-height: 1.5;
        }

        input[type="checkbox"] + label::before {
            content: "";
            position: absolute;
            left: 0;
            top: 0;
            width: 25px;
            height: 25px;
            border: 2px solid var(--primary-color);
            border-radius: 5px;
            background-color: black;
            box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            transition: all 0.2s ease;
        }

        input[type="checkbox"]:checked + label::before {
            background-color: var(--primary-color);
        }

        input[type="checkbox"]:checked + label::after {
            content: "\2713";
            position: absolute;
            left: 5px;
            top: 1px;
            color: white;
            font-size: 16px;
            font-weight: bold;
        }

        /* Priority Note */
        .priority-note {
            margin-top: 25px;
            font-size: clamp(0.85rem, 3vw, 1rem);
            font-style: italic;
            color: var(--secondary-color);
            text-align: center;
            background: rgba(0, 0, 0, 0.6);
            padding: 12px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
            line-height: 1.5;
        }

        /* Loading Modal */
        #loadingModal {
            display: none;
            text-align: center;
            color: var(--primary-color);
            font-size: clamp(1.2rem, 4vw, 1.5rem);
            padding: 30px;
        }

        /* Upgrade Modal */
        #upgradeModal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.7);
            z-index: 2000;
            text-align: center;
            max-width: 90%;
            width: 400px;
            border: 1px solid var(--primary-color);
        }

        #upgradeModal .modal-header {
            font-size: clamp(1.5rem, 5vw, 2rem);
            margin-bottom: 15px;
        }

        #upgradeModal p {
            font-size: clamp(1rem, 3vw, 1.1rem);
            margin-bottom: 25px;
            line-height: 1.5;
        }

        /* Results Section */
        .results {
            display: none;
            width: 100%;
            max-width: 800px;
            margin: 20px 0;
        }

        .results h2 {
            font-size: clamp(1.5rem, 5vw, 2rem);
            margin-bottom: 15px;
            color: var(--secondary-color);
            text-align: center;
        }

        .results p {
            font-size: clamp(1rem, 3vw, 1.1rem);
            color: #d6d6d6;
            margin-bottom: 25px;
            text-align: center;
            line-height: 1.5;
        }

        .result-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .result-item {
            background-color: #161616;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 15px rgba(176, 132, 255, 0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: transform 0.3s ease;
        }

        .result-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 20px rgba(176, 132, 255, 0.5);
        }

        .result-item img {
            width: 80px;
            height: 80px;
            object-fit: contain;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .company-name {
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 10px;
            text-align: center;
        }

        .price {
            margin-top: 15px;
            background-color: #1e1e1e;
            padding: 10px 15px;
            border-radius: 8px;
            color: var(--secondary-color);
            font-size: clamp(0.9rem, 3vw, 1rem);
            font-weight: bold;
            text-align: center;
            width: 100%;
        }

        .result-status {
            margin-top: 10px;
            font-size: clamp(0.85rem, 3vw, 0.95rem);
            text-align: center;
        }

        .matched {
            color: #4CAF50;
        }

        .unmatched {
            color: #FF9800;
        }

        .priority-details {
            margin-top: 15px;
            font-size: clamp(0.8rem, 3vw, 0.9rem);
            text-align: center;
            color: #aaa;
            width: 100%;
        }

        .check-again-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 25px;
            cursor: pointer;
            font-size: clamp(0.9rem, 3vw, 1rem);
            margin-top: 30px;
            transition: all 0.3s ease;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        .check-again-btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        .no-results {
            text-align: center;
            color: #ff6b6b;
            font-size: clamp(1rem, 3vw, 1.2rem);
            font-weight: bold;
            margin-top: 30px;
            padding: 20px;
            background-color: rgba(255, 0, 0, 0.1);
            border-radius: 8px;
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .modal-container {
                padding: 20px;
            }
            
            .checkbox-group {
                grid-template-columns: 1fr;
            }
            
            .modal-buttons {
                flex-direction: column;
            }
            
            .result-container {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            
            .modal-container {
                padding: 15px;
            }
            
            .modal-header {
                margin-bottom: 15px;
            }
            
            .modal-buttons button {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Survey Modal -->
    <div class="modal-container" id="surveyModal">
        <div class="modal-header">Vyra Basic</div>
        <div class="modal-content" id="question1">
            <p>What state are you in?</p>
            <select id="stateFrom" onchange="updateDestinationList()">
                <option value="">Select your state</option>
            </select>
        </div>

        <div class="modal-content" id="question2">
            <p>Where are you headed?</p>
            <select id="stateTo">
                <option value="">Select your destination</option>
            </select>
        </div>

        <div class="modal-content" id="question3">
            <p>What do you look for when traveling? (Choose up to 3)</p>
            <div class="checkbox-group">
                <input type="checkbox" id="comfort" name="priority" value="Comfort">
                <label for="comfort">Comfort</label>
                
                <input type="checkbox" id="LowPricing" name="priority" value="Low Pricing">
                <label for="LowPricing">Low Pricing</label>
                
                <input type="checkbox" id="safety" name="priority" value="Safety">
                <label for="safety">Safety</label>
                
                <input type="checkbox" id="Reliability" name="priority" value="Reliability">
                <label for="Reliability">Reliability</label>
                
                <input type="checkbox" id="quick" name="priority" value="Quick">
                <label for="quick">Quick</label>
                
                <input type="checkbox" id="CustomerService" name="priority" value="Customer Service">
                <label for="CustomerService">Customer Service</label>
            </div>
            
            <p class="priority-note">
                Based on your priorities, the algorithm will recommend the best for you. Transport Services metrics change daily.
            </p>
        </div>
        
        <div class="modal-buttons">
            <button id="prevButton" disabled>Previous</button>
            <button id="nextButton">Next</button>
            <button id="submitButton" style="display: none;">Submit</button>
        </div>
    </div>

    <!-- Loading Modal -->
    <div class="modal-container" id="loadingModal">
        <p>Loading your results...</p>
    </div>

    <!-- Upgrade Modal -->
    <div id="upgradeModal">
        <div class="modal-header">Upgrade Required</div>
        <p>You've reached the limit of 5 trials. Please upgrade to continue.</p>
        <button onclick="resetSurvey()">OK</button>
    </div>

    <!-- Results -->
    <div class="results" id="results"></div>

    <script>
        // List of 36 Nigerian States
        const states = [
            "Abia", "Adamawa", "Akwa Ibom", "Anambra", "Bauchi", "Bayelsa", "Benue", "Borno", "Cross River", "Delta",
            "Ebonyi", "Edo", "Ekiti", "Enugu", "Gombe", "Imo", "Jigawa", "Kaduna", "Kano", "Katsina", "Kebbi", "Kogi",
            "Kwara", "Lagos", "Nasarawa", "Niger", "Ogun", "Ondo", "Osun", "Oyo", "Plateau", "Rivers", "Sokoto",
            "Taraba", "Yobe", "Zamfara", "Abuja"
        ];

        // Transport Companies Mapped to States
        const transportCompaniesByState = {
            "Abia": {
                Comfort: ["ABC Transport","Guo Transport","Young shall grow Transport"," Aba Line", "Chisco Transport","God is Good motors","Cross Country Transport","Nsik Motors(Aktc)","New Nyanya Transport Company","Adam and Eve Motors","Benue Link Transport","Libra Motors"],
                Pricing: ["Young Shall Grow","Peace Mass Transit","Guo Transport","Benue Link transport","Libra Motors","Orizu Motors","Imo Transport (itc)"],
                Safety: ["ABC Transport","Guo Transport","Young Shall gtow transport","Chisco Transport"],
                Reliability: ["Peace Mass Transit","Young shall grow","Aba Line","Cross country Transport","Orizu Motors"],
                Quick: ["Libra Motors","Guo Transport","Abc Transport","God is Good motors","Nsik Motors(Aktc)"],
                "Customer Service": ["Libra Motors","Abc Transport","Guo Transport","Young shall grow transport","Aba Line"]
            },
            "Adamawa": {
                Comfort: ["Guo Transport","Young shall grow Transport","Chisco Transport"],
                Pricing: ["Young Shall Grow Transport"],
                Safety: ["Guo Transport","Fair okis transport"],
                Reliability: ["Fair plus transport"],
                Quick: ["Peace Mass Transit","Akwa ibom transport (Aktc)"],
                "Customer Service": ["God is Good Motors","Young shall grow motors","Guo transport"]
            },
            "Akwa Ibom": {
                Comfort: ["Chisco Transport","God is Good motors","Peace mass transit","Abc transport","Nsik motors(Aktc)"],
                Pricing: ["Peace mass transit","Cross country transport","Chisco transport","Big Joe motors"],
                Safety: ["Abc transport","God is good motors","Nsik motors(Aktc)"],
                Reliability: ["Peace Mass transit","Cross country transport","Abc transport","God is good motors"],
                Quick: ["Nsik motors(Aktc)","Chisco transport","Big Joe Motors"],
                "Customer Service": ["Peace Mass Transit","God is good motors","Abc Transport","Chicso transport"]
            },
            "Anambra": {
                Comfort: ["God is Good Motors", "ABC transport","Benue link transport","Agofure motors","E.Ekesons bros transport","Goodness and mercy transport","Okeyson motors","Tracas Nigeria","Auto star limited"],
                Pricing: ["Young Shall Grow motors","Anambra Express","Ekene dili chukwu express limited","Agofure motors","Benue links transport","okeyson motors","Peace mass transit","Goodness and mercy transport"],
                Safety: ["God is Good motors","Abc transport","Chisco transport","Nsik motors(Aktc)","Young shall grow motors","E.Ekesons limited","Interland transport"],
                Reliability: ["Anambra express motors","Nothing pass God motors","Abc transport","Nsik motors(Aktc)","Tracas Nigeria","Auto star motors","Okeyson motors","E.Ekesons bros transport","God is good motors","Chisco transport"],
                Quick: ["Guo transport","Abc transport","Nsik motors(Aktc)","God is good motors","Anambra express motors","God is good motors","Young shall grow motors"],
                "Customer Service": ["God is Good Motors","Chisco transport","Abc transport","Guo transport","Nsik motors","Anambra express","Interland transport","Goodness and mercy transport","Benue links transport"]
            },
            "Bauchi": {
                Comfort: ["Guo Transport","Abc Transport", "Benue links transport","Yankari express"],
                Pricing: ["Peace Mass Transit","Young shall grow transport","Gombe line","Yankari express"],
                Safety: ["Guo transport","Abc transport","Gombe line","Benue links transport","Cross country transport"],
                Reliability: ["Benue links transport","Peace mass transit","Gombe line","Yankari express"],
                Quick: ["Guo transport","Benue links transport","Yankari express","Abc transport"],
                "Customer Service": ["Young shall grow transport","Abc transport","Cross country transport","Benue links transport"]
            },
            "Bayelsa": {
                Comfort: ["God is Good Motors","Abc transport","Agofure motors","Delta line"],
                Pricing: ["Peace mass transit","Agofure motors","Balyesa state transport"],
                Safety: ["Good is good motors","Abc transport","Chisco transport","Delta line"],
                Reliability: ["Delta Line","Abc transport","God is good","Balyesa state transport","Agofure motors"],
                Quick: ["Delta line","Good is good motors","Peace mass transit"],
                "Customer Service": ["God is Good Motors","Abc transport","God is good motors","Balyesa state motors"]
            },
            "Benue": {
                Comfort: ["ABC Transport","God is good","Guo transport"],
                Pricing: ["GUO Transport","Peace mass transit","Young shall grow motors"],
                Safety: ["Abc transport","Young shall grow motors","God is good motors"],
                Reliability: ["Peace Mass Transit","Orizu motors","The young legacy motors","Benue links transport"],
                Quick: ["God is good","Benue links transport"],
                "Customer Service": ["ABC Transport","Benue links transport","Young shall grow motors","Guo transport","God is good motors"]
            },
            "Borno": {
                Comfort: ["Borno express","Guo transport"],
                Pricing: ["Gombe line","Peace mass transit"],
                Safety: ["Borno express","Guo transport"],
                Reliability: ["Peace Mass Transit","Cross country transport"],
                Quick: ["Cross country transport"],
                "Customer Service": ["Peace Mass Transit","Guo transport","Gombe line"]
            },
            "Cross River": {
                Comfort: ["God is Good Motors"],
                Pricing: ["GUO Transport"],
                Safety: ["Faith Motors"],
                Reliability: ["Delta Line"],
                Quick: ["Peace Mass Transit"],
                "Customer Service": ["God is Good Motors"]
            },
            "Delta": {
                Comfort: ["ABC Transport"],
                Pricing: ["Young Shall Grow"],
                Safety: ["Ibom Transit"],
                Reliability: ["Peace Mass Transit"],
                Quick: ["Libra Motors"],
                "Customer Service": ["ABC Transport"]
            },
            "Ebonyi": {
                Comfort: ["Chisco Transport"],
                Pricing: ["GUO Transport"],
                Safety: ["Faith Motors"],
                Reliability: ["Delta Line"],
                Quick: ["Libra Motors"],
                "Customer Service": ["Chisco Transport"]
            },
            "Edo": {
                Comfort: ["God is Good Motors"],
                Pricing: ["Young Shall Grow"],
                Safety: ["Ibom Transit"],
                Reliability: ["Peace Mass Transit"],
                Quick: ["Libra Motors"],
                "Customer Service": ["God is Good Motors"]
            },
            "Ekiti": {
                Comfort: ["ABC Transport"],
                Pricing: ["GUO Transport"],
                Safety: ["Faith Motors"],
                Reliability: ["Peace Mass Transit"],
                Quick: ["Libra Motors"],
                "Customer Service": ["ABC Transport"]
            },
            "Enugu": {
                Comfort: ["ABC Transport"],
                Pricing: ["Young Shall Grow"],
                Safety: ["Glo Bus Transit"],
                Reliability: ["Fellow Transport"],
                Quick: ["Tega Express"],
                "Customer Service": ["ABC Transport"]
            },
            "Gombe": {
                Comfort: ["Chisco Transport"],
                Pricing: ["GUO Transport"],
                Safety: ["Faith Motors"],
                Reliability: ["Peace Mass Transit"],
                Quick: ["Libra Motors"],
                "Customer Service": ["Chisco Transport"]
            },
            "Imo": {
                Comfort: ["God is Good Motors"],
                Pricing: ["Young Shall Grow"],
                Safety: ["Ibom Transit"],
                Reliability: ["Delta Line"],
                Quick: ["Peace Mass Transit"],
                "Customer Service": ["God is Good Motors"]
            },
            "Jigawa": {
                Comfort: ["ABC Transport"],
                Pricing: ["GUO Transport"],
                Safety: ["Faith Motors"],
                Reliability: ["Peace Mass Transit"],
                Quick: ["Libra Motors"],
                "Customer Service": ["ABC Transport"]
            },
            "Kaduna": {
                Comfort: ["Chisco Transport"],
                Pricing: ["Young Shall Grow"],
                Safety: ["Ibom Transit"],
                Reliability: ["Peace Mass Transit"],
                Quick: ["Libra Motors"],
                "Customer Service": ["Peace Mass Transit"]
            },
            "Kano": {
                Comfort: ["God is Good Motors"],
                Pricing: ["GUO Transport"],
                Safety: ["Faith Motors"],
                Reliability: ["Delta Line"],
                Quick: ["Peace Mass Transit"],
                "Customer Service": ["God is Good Motors"]
            },
            "Katsina": {
                Comfort: ["ABC Transport"],
                Pricing: ["Young Shall Grow"],
                Safety: ["Ibom Transit"],
                Reliability: ["Peace Mass Transit"],
                Quick: ["Libra Motors"],
                "Customer Service": ["ABC Transport"]
            },
            "Kebbi": {
                Comfort: ["Chisco Transport"],
                Pricing: ["GUO Transport"],
                Safety: ["Faith Motors"],
                Reliability: ["Delta Line"],
                Quick: ["Libra Motors"],
                "Customer Service": ["Chisco Transport"]
            },
            "Kogi": {
                Comfort: ["God is Good Motors"],
                Pricing: ["Young Shall Grow"],
                Safety: ["Ibom Transit"],
                Reliability: ["Peace Mass Transit"],
                Quick: ["Libra Motors"],
                "Customer Service": ["God is Good Motors"]
            },
            "Kwara": {
                Comfort: ["ABC Transport"],
                Pricing: ["GUO Transport"],
                Safety: ["Faith Motors"],
                Reliability: ["Delta Line"],
                Quick: ["Libra Motors"],
                "Customer Service": ["ABC Transport"]
            },
            "Lagos": {
                Comfort: ["God is Good Motors", "Chisco Transport"],
                Pricing: ["Young Shall Grow", "GUO Transport"],
                Safety: ["Faith Motors"],
                Reliability: ["Peace Mass Transit"],
                Quick: ["Libra Motors"],
                "Customer Service": ["God is Good Motors"]
            },
            "Nasarawa": {
                Comfort: ["ABC Transport"],
                Pricing: ["GUO Transport"],
                Safety: ["Faith Motors"],
                Reliability: ["Delta Line"],
                Quick: ["Peace Mass Transit"],
                "Customer Service": ["ABC Transport"]
            },
            "Niger": {
                Comfort: ["Chisco Transport"],
                Pricing: ["Young Shall Grow"],
                Safety: ["Ibom Transit"],
                Reliability: ["Peace Mass Transit"],
                Quick: ["Libra Motors"],
                "Customer Service": ["Chisco Transport"]
            },
            "Ogun": {
                Comfort: ["God is Good Motors"],
                Pricing: ["GUO Transport"],
                Safety: ["Faith Motors"],
                Reliability: ["Delta Line"],
                Quick: ["Peace Mass Transit"],
                "Customer Service": ["God is Good Motors"]
            },
            "Ondo": {
                Comfort: ["ABC Transport"],
                Pricing: ["Young Shall Grow"],
                Safety: ["Ibom Transit"],
                Reliability: ["Peace Mass Transit"],
                Quick: ["Libra Motors"],
                "Customer Service": ["ABC Transport"]
            },
            "Osun": {
                Comfort: ["Chisco Transport"],
                Pricing: ["GUO Transport"],
                Safety: ["Faith Motors"],
                Reliability: ["Delta Line"],
                Quick: ["Libra Motors"],
                "Customer Service": ["Chisco Transport"]
            },
            "Oyo": {
                Comfort: ["God is Good Motors"],
                Pricing: ["Young Shall Grow"],
                Safety: ["Ibom Transit"],
                Reliability: ["Peace Mass Transit"],
                Quick: ["Libra Motors"],
                "Customer Service": ["God is Good Motors"]
            },
            "Plateau": {
                Comfort: ["ABC Transport"],
                Pricing: ["GUO Transport"],
                Safety: ["Faith Motors"],
                Reliability: ["Delta Line"],
                Quick: ["Libra Motors"],
                "Customer Service": ["ABC Transport"]
            },
            "Rivers": {
                Comfort: ["God is Good Motors"],
                Pricing: ["Young Shall Grow"],
                Safety: ["Ibom Transit"],
                Reliability: ["Peace Mass Transit"],
                Quick: ["Libra Motors"],
                "Customer Service": ["God is Good Motors"]
            },
            "Sokoto": {
                Comfort: ["Chisco Transport"],
                Pricing: ["GUO Transport"],
                Safety: ["Faith Motors"],
                Reliability: ["Delta Line"],
                Quick: ["Libra Motors"],
                "Customer Service": ["Chisco Transport"]
            },
            "Taraba": {
                Comfort: ["ABC Transport"],
                Pricing: ["Young Shall Grow"],
                Safety: ["Ibom Transit"],
                Reliability: ["Peace Mass Transit"],
                Quick: ["Libra Motors"],
                "Customer Service": ["ABC Transport"]
            },
            "Yobe": {
                Comfort: ["God is Good Motors"],
                Pricing: ["GUO Transport"],
                Safety: ["Faith Motors"],
                Reliability: ["Delta Line"],
                Quick: ["Peace Mass Transit"],
                "Customer Service": ["God is Good Motors"]
            },
            "Zamfara": {
                Comfort: ["Chisco Transport"],
                Pricing: ["Young Shall Grow"],
                Safety: ["Ibom Transit"],
                Reliability: ["Peace Mass Transit"],
                Quick: ["Libra Motors"],
                "Customer Service": ["Chisco Transport"]
            },
            "Abuja": {
                Comfort: ["God is Good Motors", "ABC Transport"],
                Pricing: ["Young Shall Grow"],
                Safety: ["Ibom Transit"],
                Reliability: ["Delta Line"],
                Quick: ["Peace Airk"],
                "Customer Service": ["God is Good Motors"]
            }
        };

        // Transport Company Images
        const companyImages = {
            "Chisco Transport": "https://i.ibb.co/b7Yykmb/images-12.png",
            "God is Good Motors": "https://i.ibb.co/dKmkMGJ/images-11.png",
            "ABC Transport": "https://i.ibb.co/5hXDcq5/images-7.png",
            "Young Shall Grow": "https://i.ibb.co/wKRrKtp/test-10.png",
            "Peace Mass Transit": "https://i.ibb.co/5hXDcq5/images-7.png",
            "GUO Transport": "https://i.ibb.co/wKRrKtp/test-10.png"
        };

        // DOM Elements
        const surveyModal = document.getElementById("surveyModal");
        const resultsDiv = document.getElementById("results");
        const loadingModal = document.getElementById("loadingModal");
        const upgradeModal = document.getElementById("upgradeModal");
        const questions = document.querySelectorAll(".modal-content");
        const prevButton = document.getElementById("prevButton");
        const nextButton = document.getElementById("nextButton");
        const submitButton = document.getElementById("submitButton");
        let currentQuestion = 0;
        let searchCount = 0;

        // Function to populate dropdowns
        function populateDropdowns() {
            const stateFromDropdown = document.getElementById("stateFrom");
            const stateToDropdown = document.getElementById("stateTo");

            states.forEach(state => {
                let option1 = new Option(state, state);
                let option2 = new Option(state, state);
                stateFromDropdown.appendChild(option1);
                stateToDropdown.appendChild(option2);
            });
        }

        // Function to update destination dropdown
        function updateDestinationList() {
            const selectedState = document.getElementById("stateFrom").value;
            const stateToDropdown = document.getElementById("stateTo");

            // Clear existing options
            stateToDropdown.innerHTML = '<option value="">Select your destination</option>';

            // Add only states except the selected one
            states.forEach(state => {
                if (state !== selectedState) {
                    let option = new Option(state, state);
                    stateToDropdown.appendChild(option);
                }
            });
        }

        // Function to get random price with caching
        function getRandomPrice(companyName) {
            if (!companyName) return 25000;

            let today = new Date();
            let baseDay = Math.floor(today.getTime() / (1000 * 60 * 60 * 24 * 2));
            let storageKey = `price_${companyName}_${baseDay}`;
            let storedPrice = localStorage.getItem(storageKey);

            if (storedPrice) {
                return parseInt(storedPrice);
            } else {
                let previousDay = baseDay - 1;
                let prevPriceKey = `price_${companyName}_${previousDay}`;
                let prevPrice = localStorage.getItem(prevPriceKey);
                let newPrice;

                if (prevPrice) {
                    prevPrice = parseInt(prevPrice);
                    let priceChange = Math.floor(Math.random() * 2000) - 1000;
                    newPrice = Math.min(32000, Math.max(20000, prevPrice + priceChange));
                } else {
                    let companySeed = companyName.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
                    let basePrice = 22000 + (companySeed % 8000);
                    let randomOffset = Math.floor(Math.random() * 3000) - 1500;
                    newPrice = Math.min(32000, Math.max(20000, basePrice + randomOffset));
                }

                localStorage.setItem(storageKey, newPrice);
                return newPrice;
            }
        }

        // Function to reset the survey
        function resetSurvey() {
            resultsDiv.style.display = "none";
            surveyModal.style.display = "block";
            upgradeModal.style.display = "none";
            currentQuestion = 0;
            questions.forEach((q) => q.classList.remove("active"));
            questions[0].classList.add("active");
            prevButton.disabled = true;
            nextButton.style.display = "block";
            submitButton.style.display = "none";
            
            // Reset form elements
            document.getElementById("stateFrom").value = "";
            document.getElementById("stateTo").innerHTML = '<option value="">Select your destination</option>';
            document.querySelectorAll('input[name="priority"]:checked').forEach(cb => cb.checked = false);
        }

        // Function to handle form submission
        function handleSubmit() {
            const selectedState = document.getElementById("stateFrom").value;
            const destinationState = document.getElementById("stateTo").value;
            const priorities = Array.from(document.querySelectorAll('input[name="priority"]:checked'))
                .map((cb) => cb.value);

            if (!selectedState || !destinationState) {
                alert("Please select both departure and destination states.");
                return;
            }

            if (priorities.length !== 3) {
                alert("Please select exactly 3 priorities.");
                return;
            }

            if (searchCount >= 5) {
                surveyModal.style.display = "none";
                upgradeModal.style.display = "flex";
                return;
            }

            searchCount++;

            surveyModal.style.display = "none";
            loadingModal.style.display = "block";

            setTimeout(() => {
                loadingModal.style.display = "none";
                resultsDiv.style.display = "block";

                // Header
                resultsDiv.innerHTML = `
                    <h2>Recommended Transport Companies</h2>
                    <p>Available from ${selectedState} to ${destinationState} based on your priorities:</p>
                    <div class="result-container" id="company-results"></div>
                `;

                let stateCompanies = transportCompaniesByState[selectedState] || {};
                let destinationCompanies = transportCompaniesByState[destinationState] || {};
                let companyResultsDiv = document.getElementById("company-results");

                // Collect matching companies
                const companyResults = [];
                Object.keys(stateCompanies).forEach(priority => {
                    if (priorities.includes(priority)) {
                        stateCompanies[priority].forEach(company => {
                            const isAvailableInDestination = destinationCompanies[priority]?.includes(company);
                            const imageUrl = companyImages[company] || "https://via.placeholder.com/50?text=Default";
                            const price = getRandomPrice(company);

                            companyResults.push({
                                company,
                                priority,
                                imageUrl,
                                price,
                                isAvailableInDestination,
                                matchedPriorities: priority,
                                unmatchedPriorities: priorities.filter(p => p !== priority)
                            });
                        });
                    }
                });

                // Limit results and display
                const RESULTS_LIMIT = 3;
                const limitedResults = companyResults.slice(0, RESULTS_LIMIT);

                if (limitedResults.length > 0) {
                    limitedResults.forEach(result => {
                        companyResultsDiv.innerHTML += `
                            <div class="result-item">
                                <span class="company-name">${result.company}</span>
                                <img src="${result.imageUrl}" alt="${result.company}">
                                <div class="price">Approximate price: &#8358;${result.price.toLocaleString()}</div>
                                <div class="result-status ${result.isAvailableInDestination ? 'matched' : 'unmatched'}">
                                    ${result.isAvailableInDestination 
                                        ? 'Fully matches your priorities'
                                        : 'Partially matches your priorities'}
                                </div>
                                <div class="priority-details">
                                    <div>Matched: ${result.matchedPriorities}</div>
                                    <div>Unmatched: ${result.isAvailableInDestination ? "None" : result.unmatchedPriorities.join(", ")}</div>
                                </div>
                            </div>
                        `;
                    });
                } else {
                    companyResultsDiv.innerHTML = `
                        <p class="no-results">
                            No results for your destination or selected priorities. 
                            Try changing one or more priorities.
                        </p>
                    `;
                }

                resultsDiv.innerHTML += `
                    <button class="check-again-btn" onclick="resetSurvey()">Check Again</button>
                `;
            }, 2000);
        }

        // Initialize the survey
        document.addEventListener("DOMContentLoaded", function() {
            populateDropdowns();
            
            // Show first question
            questions[currentQuestion].classList.add("active");
            
            // Next button handler
            nextButton.addEventListener("click", () => {
                questions[currentQuestion].classList.remove("active");
                currentQuestion++;
                questions[currentQuestion].classList.add("active");

                prevButton.disabled = false;

                if (currentQuestion === questions.length - 1) {
                    nextButton.style.display = "none";
                    submitButton.style.display = "block";
                }
            });
            
            // Previous button handler
            prevButton.addEventListener("click", () => {
                questions[currentQuestion].classList.remove("active");
                currentQuestion--;
                questions[currentQuestion].classList.add("active");

                nextButton.style.display = "block";
                submitButton.style.display = "none";

                if (currentQuestion === 0) {
                    prevButton.disabled = true;
                }
            });
            
            // Submit button handler
            submitButton.addEventListener("click", handleSubmit);
            
            // Upgrade modal OK button
            document.querySelector("#upgradeModal button").addEventListener("click", resetSurvey);
            
            // Limit checkboxes to 3 selections
            const checkboxes = document.querySelectorAll('input[name="priority"]');
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const checkedCount = document.querySelectorAll('input[name="priority"]:checked').length;
                    if (checkedCount > 3) {
                        this.checked = false;
                    }
                });
            });
        });
    </script>
</body>
</html>
